name: Simple GitHub Pages Deploy

on:
  push:
    branches: [ enhanced-auto-docs-system, main ]
  workflow_dispatch:

# Basic permissions for repository access
permissions:
  contents: write

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Verify presentation directory
        run: |
          echo "📂 Checking presentation directory..."
          if [ -d "presentation" ]; then
            echo "✅ Presentation directory exists"
            ls -la presentation/
            echo "📊 File sizes:"
            du -h presentation/*
            echo "📝 Content preview:"
            head -10 presentation/index.html
          else
            echo "❌ Presentation directory not found"
            exit 1
          fi
        
      - name: Deploy to gh-pages branch
        run: |
          echo "🚀 Deploying to gh-pages branch..."
          
          # Configure git
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          
          # Create or switch to gh-pages branch
          git checkout -B gh-pages
          
          # Copy presentation files to root
          cp -r presentation/* .
          
          # Remove unnecessary files for gh-pages
          rm -rf src/ tests/ scripts/ .github/ requirements.txt demo.py mcp_server.py
          
          # Add all files and commit
          git add .
          git commit -m "🚀 Deploy Campus Party Brasil 2025 presentation

          Deployed from: ${{ github.sha }}
          Branch: ${{ github.ref_name }}
          
          ✅ Reveal.js presentation ready
          🎯 Direct deployment to gh-pages
          
          Generated by: GitHub Actions" || echo "No changes to commit"
          
          # Push to gh-pages
          git push origin gh-pages --force
          
          echo "✅ Deployment complete!"
          echo "🌐 Presentation should be available at: https://lucasdoreac.github.io/ai-quality-assurance-cpbr2025/"